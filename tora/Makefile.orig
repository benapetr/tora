############################################################################
#
# TOra - An Oracle Toolkit for DBA's and developers
# Copyright (C) 2000  GlobeCom AB
# 
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 2
# of the License, or (at your option) any later version.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
#
############################################################################

TITLE=TOra
SUBDIRS=
SOURCES=\
	toabout.cpp 		\
	tobrowser.cpp		\
	toconnection.cpp	\
	todebug.cpp		\
	todebugchange.cpp	\
	todebugtext.cpp		\
	todebugwatch.cpp	\
	tofilesize.cpp		\
	toglobalsetting.cpp     \
	tohighlightedtext.cpp	\
	tomain.cpp		\
	tomarkedtext.cpp	\
	tonewconnection.cpp	\
	tonoblockquery.cpp	\
	tooutput.cpp		\
	toparamget.cpp		\
	topreferences.cpp	\
	toresultcols.cpp	\
	toresultconstraint.cpp	\
	toresultcontent.cpp	\
	toresultdepend.cpp	\
	toresultfield.cpp	\
	toresultindexes.cpp	\
	toresultitem.cpp	\
	toresultlock.cpp	\
	toresultlong.cpp	\
	toresultplan.cpp	\
	toresultreferences.cpp	\
	toresultstats.cpp	\
	toresultstorage.cpp	\
	toresultview.cpp	\
	torollback.cpp		\
	tosession.cpp		\
	tosgastatement.cpp	\
	tosgatrace.cpp		\
	tosql.cpp		\
	tosqledit.cpp		\
	tostorage.cpp		\
	tostoragedefinition.cpp	\
	tosyntaxsetup.cpp	\
	tothread.cpp		\
	totool.cpp		\
	toworksheet.cpp		\
	utils.cpp		\

TARGET=tora-plugin

TOVERSION=-DTOVERSION=\"0.7\"

include Makefile.setup
include Makefile.common

plugins/tobrowser.so:objs/tobrowser.o
plugins/todebug.so:\
	objs/todebug.o \
	objs/todebugwatch.o \
	objs/todebugtext.o \
	objs/todebugchange.o
plugins/tofilesize.so:objs/tofilesize.o
plugins/tooutput.so:objs/tooutput.o
plugins/tonoblockquery.so:objs/tonoblockquery.o
plugins/toparamget.so:objs/toparamget.o
plugins/toresultcols.so:objs/toresultcols.o
plugins/toresultconstraint.so:objs/toresultconstraint.o
plugins/toresultcontent.so:objs/toresultcontent.o
plugins/toresultdepend.so:objs/toresultdepend.o
plugins/toresultindexes.so:objs/toresultindexes.o
plugins/toresultlock.so:objs/toresultlock.o
plugins/toresultlong.so:objs/toresultlong.o
plugins/toresultreferences.so:objs/toresultreferences.o
plugins/toresultstats.so:objs/toresultstats.o
plugins/toresultstorage.so:objs/toresultstorage.o
plugins/torollback.so:objs/torollback.o
plugins/tosession.so:objs/tosession.o
plugins/tosgastatement.so:objs/tosgastatement.o
plugins/tosgatrace.so:objs/tosgatrace.o
plugins/tosqledit.so:objs/tosqledit.o
plugins/tostorage.so:objs/tostorage.o
plugins/tostoragedefinition.so:objs/tostoragedefinition.o
plugins/toworksheet.so:objs/toworksheet.o

# Monolithic target, for non ELF platforms

tora-mono: $(OBJECTS) main.cpp
	@echo Linking $@
	$(CC) $(CFLAGS) $(LFLAGS) $(LFLAGS_GLOB) -DTOMONOLITHIC -o $@ $(OBJECTS) main.cpp \
		$(LIBS_GLOB) $(STDCPP_SHARED) $(ORACLE_SHARED) $(QT_SHARED)

# Static target, easier to distribute

tora-static: $(OBJECTS) main.cpp
	@echo Linking $@
	$(CC) $(LFLAGS) $(CFLAGS) $(LFLAGS_GLOB) -DTOMONOLITHIC -o $@ $(OBJECTS) main.cpp \
		$(QT_STATIC) $(STDCPP_STATIC) $(ORACLE_STATIC) $(LIBS_GLOB) -L/usr/X11R6/lib -lXt -lz -ljpeg -lXext

# Plugin based binary and its plugins

tora-plugin: \
	tora \
	plugins/tobrowser.so \
	plugins/todebug.so \
	plugins/tofilesize.so \
	plugins/tonoblockquery.so \
	plugins/tooutput.so \
	plugins/toparamget.so \
	plugins/toresultcols.so \
	plugins/toresultconstraint.so \
	plugins/toresultcontent.so \
	plugins/toresultdepend.so \
	plugins/toresultindexes.so \
	plugins/toresultlock.so \
	plugins/toresultlong.so \
	plugins/toresultreferences.so \
	plugins/toresultstats.so \
	plugins/toresultstorage.so \
	plugins/torollback.so \
	plugins/tosession.so \
	plugins/tosgastatement.so \
	plugins/tosgatrace.so \
	plugins/tosqledit.so \
	plugins/tostorage.so \
	plugins/tostoragedefinition.so \
	plugins/toworksheet.so \

# The binary for the pluginbased tora

tora: \
	objs/main.o \
	objs/toabout.o \
	objs/toconnection.o \
	objs/toglobalsetting.o \
	objs/tohighlightedtext.o \
	objs/tomain.o \
	objs/tomarkedtext.o \
	objs/tonewconnection.o \
	objs/topreferences.o \
	objs/toresultfield.o \
	objs/toresultitem.o \
	objs/toresultplan.o \
	objs/toresultview.o \
	objs/tosql.o \
	objs/tosyntaxsetup.o \
	objs/tothread.o \
	objs/totool.o \
	objs/utils.o
	@echo Linking $@
	$(CC) $(LFLAGS) -Xlinker "--export-dynamic" $(LFLAGS_GLOB) \
		-o $@ $^ $(LIBS_GLOB) $(ORACLE_SHARED) $(STDCPP_SHARED) $(QT_SHARED)
